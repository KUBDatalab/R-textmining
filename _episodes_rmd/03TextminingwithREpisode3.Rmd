---
title: "Episode 3 word frequency analysis"
teaching: 0
exercises: 0
questions:
- "What is a model?"
objectives:
- "First learning objective. (FIXME)"
keypoints:
- "First key point. Brief Answer to questions. (FIXME)"
---


```{r, include = FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("03-")
```


## R Markdown
## Word frequency
Now that we have seen the average sentiment of the parties, we want to get a deeper understanding of what they talk about when discussing China. We can calculate the most frequent words that each party uses, and then visualize that to get an impression of what they talk about when discussing China.

```{r}
kina_tidy_blokke %>% 
  filter(Role != "formand") %>% 
  group_by(Party) %>% 
  count(word, sort = TRUE) %>%
  top_n(10) %>% 
  ungroup() %>% 
  mutate(word = reorder_within(word, n, Party)) %>% 
  ggplot(aes(n, word, fill = Party)) +
  geom_col() + 
  facet_wrap(~Party, scales = "free_y") +
  scale_y_reordered() +
  labs(x = "Word occurrences")
```

Unfortunately for us, most of the most common words are words that act like stopwords, carrying no meaning in themselves. To get around this, we can create our own custom list of stopwords as a tibble, and then anti_join it with the dataset, just like we did for the already exisitng stopword list.

First we look at the top 50 words to find the stopwords for our custom stopword list

```{r}
kina_tidy_blokke %>% 
  filter(Role != "formand") %>% 
  count(word, sort = TRUE) %>% 
  top_n(50) %>% 
  tbl_df %>% 
  print(n=50)
```

Based on this, we select the words that we consider stopwords and make them into a tibble

```{r}
custom_stopwords <- tibble(word = c("sker", "kan", "så", "sige", "hr", "søren", "espersen", "synes", "ved", "altså", "få", "andre", "står", "må", "derfor"))
```

```{r}
kina_tidy_blokke2 <- kina_tidy_blokke %>% 
  anti_join(custom_stopwords, by = "word")
```

Let's now make our plot again



This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r libraries & data, eval=FALSE}
library(tidyverse)
library(tm)
read.delim("../data/AFINN dansk.txt")
```

